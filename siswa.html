<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>E-KAROMAH - Panel Siswa</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root {
  --primary: #10b981;
  --accent: #fbbf24;
  --bg-gradient: linear-gradient(135deg, #022c22 0%, #064e3b 100%);
  --card-bg: rgba(6, 78, 59, 0.5);
  --border: rgba(255, 255, 255, 0.15);
  --text: #f1f5f9;
}

body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: var(--bg-gradient);
  color: var(--text);
  min-height: 100vh;
  padding-bottom: 80px;
}

/* Header Sticky */
.header-container {
  background: rgba(2, 44, 34, 0.95);
  backdrop-filter: blur(10px);
  position: sticky;
  top: 0;
  z-index: 100;
  padding: 15px 20px;
  border-bottom: 2px solid var(--accent);
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  display: flex; justify-content: space-between; align-items: center;
}

h2 { margin: 0; font-size: 18px; color: var(--accent); }
.logout-mini { font-size: 12px; color: #ef4444; cursor: pointer; text-decoration: underline; }

.container { max-width: 800px; margin: auto; padding: 20px; }

.user-info-card {
  background: linear-gradient(135deg, #064e3b, #047857);
  padding: 20px;
  border-radius: 16px;
  border: 1px solid var(--border);
  font-size: 14px;
  margin-bottom: 20px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}
.user-info-card b { color: var(--accent); }

/* Form Sections */
.section {
  background: var(--card-bg);
  padding: 20px;
  border-radius: 16px;
  margin-bottom: 16px;
  border: 1px solid var(--border);
}

.section h4 {
  margin: 0 0 15px 0;
  font-size: 16px;
  font-weight: 500;
  display: flex; align-items: center; color: #a7f3d0;
}
.section h4::before {
  content: '';
  display: inline-block;
  width: 4px; height: 16px;
  background: var(--accent);
  margin-right: 10px;
  border-radius: 2px;
}

/* Radio Buttons Styling (Pills) */
.radio-group {
  display: flex;
  background: rgba(0,0,0,0.3);
  padding: 4px;
  border-radius: 12px;
  margin-bottom: 15px;
  gap: 5px;
}

.radio-group label {
  flex: 1;
  text-align: center;
  padding: 10px;
  cursor: pointer;
  border-radius: 8px;
  transition: 0.3s;
  font-size: 13px;
  font-weight: 500;
  position: relative;
  overflow: hidden;
  color: #94a3b8;
}

.radio-group input { position: absolute; opacity: 0; }

/* Active State for Radio */
.radio-group input:checked + span {
  background: var(--primary);
  color: #022c22;
  font-weight: 700;
  box-shadow: 0 2px 10px rgba(16, 185, 129, 0.3);
}

.radio-label-text {
  display: block; width: 100%; height: 100%; padding: 8px 0;
  border-radius: 8px;
}

/* Input Text */
input[type="text"], textarea {
    width: 100%;
    padding: 12px;
    background: rgba(0,0,0,0.3);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: white;
    box-sizing: border-box;
    font-family: inherit;
}
input[type="text"]:focus, textarea:focus {
    outline: 2px solid var(--accent);
    background: rgba(0,0,0,0.5);
}

/* Floating Action Button (Submit) */
.fab-container {
  position: fixed;
  bottom: 20px;
  left: 0; right: 0;
  padding: 0 20px;
  max-width: 800px;
  margin: auto;
  pointer-events: none; /* Supaya klik tembus di area kosong */
}

.submit-btn {
  pointer-events: auto;
  width: 100%;
  background: var(--accent);
  color: #022c22;
  border: none;
  padding: 16px;
  border-radius: 14px;
  font-size: 16px;
  font-weight: 700;
  box-shadow: 0 10px 25px rgba(0,0,0,0.5);
  cursor: pointer;
  transition: transform 0.2s;
}

.submit-btn:active { transform: scale(0.98); }

</style>
</head>
<body>

<div class="header-container">
    <h2>ðŸ•Œ Panel Siswa</h2>
    <span class="logout-mini" onclick="logout()">Logout</span>
</div>

<div class="container">
    
    <div class="user-info-card">
        Selamat Datang, <b id="namaSiswa">Siswa</b><br>
        Kelompok: <span id="kelompokSiswa">-</span>
    </div>

    <form id="laporanForm" onsubmit="kirimLaporan(event)">
        
        <div class="section">
            <h4>Kehadiran</h4>
            <div class="radio-group">
                <label>
                    <input type="radio" name="hadir" value="Hadir" checked>
                    <span class="radio-label-text">Hadir</span>
                </label>
                <label>
                    <input type="radio" name="hadir" value="Izin">
                    <span class="radio-label-text">Izin</span>
                </label>
                <label>
                    <input type="radio" name="hadir" value="Sakit">
                    <span class="radio-label-text">Sakit</span>
                </label>
            </div>
        </div>

        <div class="section">
            <h4>Kegiatan Ibadah</h4>
            <textarea name="kegiatan" rows="4" placeholder="Contoh: Sholat Dhuha, Tadarus Al-Quran Juz 1..."></textarea>
        </div>

        <div class="fab-container">
            <button type="submit" class="submit-btn">ðŸš€ KIRIM LAPORAN</button>
        </div>
    </form>
</div>

<script>
    // Konfigurasi
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxoY-pOhMN5zRptRwO8GQjOIGPyN6YL6uZywUCs3QL8aWDNyAHugqgLTcee_z4jcRZZEw/exec"; // Ganti URL ini
    const user = JSON.parse(localStorage.getItem("user"));

    if(!user || user.role !== 'siswa'){
        alert("Silakan login sebagai siswa.");
        location.href = 'index.html';
    } else {
        document.getElementById('namaSiswa').textContent = user.nama;
        document.getElementById('kelompokSiswa').textContent = user.kelompok;
    }

    function logout(){
        if(confirm("Keluar aplikasi?")){
            localStorage.removeItem("user");
            location.href = "index.html";
        }
    }

    function kirimLaporan(e){
        e.preventDefault();
        const btn = document.querySelector('.submit-btn');
        const form = document.getElementById('laporanForm');
        
        btn.innerHTML = "â³ Mengirim...";
        btn.disabled = true;

        const fd = new FormData(form);
        fd.append("action", "inputSiswa");
        fd.append("nama", user.nama);
        fd.append("kelompok", user.kelompok);

        fetch(WEB_APP_URL, { method: "POST", body: fd })
        .then(r => r.text())
        .then(res => {
            alert("âœ… Laporan Berhasil Dikirim!");
            form.reset();
        })
        .catch(err => alert("âŒ Gagal mengirim: " + err))
        .finally(() => {
            btn.innerHTML = "ðŸš€ KIRIM LAPORAN";
            btn.disabled = false;
        });
    }
</script>

</body>
</html>
