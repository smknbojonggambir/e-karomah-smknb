<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>E-KAROMAH SMKNB - Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:system-ui;
  background:linear-gradient(135deg,#0f172a,#1e293b);
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.card{
  background:rgba(255,255,255,.08);
  padding:35px 25px;
  border-radius:20px;
  text-align:center;
  width:320px;
  backdrop-filter:blur(10px);
}

.logo{
  width:90px;
  background:white;
  padding:6px;
  border-radius:50%;
  margin-bottom:10px;
}

h2{
  margin:10px 0 5px;
}

p{
  margin:0 0 15px;
  font-size:14px;
  opacity:.8;
}

input{
  width:100%;
  padding:12px;
  margin:6px 0;
  border:none;
  border-radius:10px;
  outline:none;
}

button{
  width:100%;
  padding:12px;
  margin-top:10px;
  background:#2563eb;
  color:white;
  border:none;
  border-radius:12px;
  font-weight:600;
  cursor:pointer;
}

button:hover{
  background:#1d4ed8;
}

select{
  width:100%;
  padding:12px;
  margin:6px 0;
  border:none;
  border-radius:10px;
}

#msg{
  margin-top:10px;
  font-size:14px;
}
</style>
</head>

<body>

<div class="card">

<img class="logo"
src="https://raw.githubusercontent.com/smknbojonggambir/E-RAMADHAN-SMKNB/main/LOGO.png">

<h2>E-KAROMAH SMKNB</h2>
<p>Silakan Login</p>

<select id="role">
  <option value="">Pilih Role</option>
  <option value="siswa">Siswa</option>
  <option value="pembimbing">Pembimbing</option>
  <option value="admin">Admin</option>
</select>

<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">

<button onclick="login()">Login</button>

<div id="msg"></div>

</div>


<script>

const WEB_APP_URL="https://script.google.com/macros/s/AKfycbzG_JwpZBfC5-e_wMGf5mhufKbxJIpXE97LdGFknRkFBNAhgI6tF_d1zM1v4gyGmVmOfA/exec";

async function login(){

  if(!role.value){
    msg.innerHTML="⚠️ Pilih role terlebih dahulu";
    return;
  }

  if(!user.value || !pass.value){
    msg.innerHTML="⚠️ Username & Password wajib diisi";
    return;
  }

  msg.innerHTML="⏳ Memproses...";

  let r = await fetch(WEB_APP_URL+
    "?action=login"+
    "&user="+encodeURIComponent(user.value)+
    "&pass="+encodeURIComponent(pass.value)+
    "&role="+role.value
  );

  let d = await r.json();

  if(d.status=="ok"){

    sessionStorage.setItem("user",d.user);
    sessionStorage.setItem("role",d.role);
    sessionStorage.setItem("kelompok",d.kelompok||"");

    if(d.role=="siswa") location="siswa.html";
    if(d.role=="pembimbing") location="pembimbing.html";
    if(d.role=="admin") location="admin.html";

  }else{

    msg.innerHTML="❌ Login gagal. Periksa data!";

  }

}

</script>

</body>
</html>
