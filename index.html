<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Dashboard Admin Sekolah</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f6f9;
    margin:0;
}

header{
    background:#2c3e50;
    color:white;
    padding:15px;
    text-align:center;
}

.container{
    padding:20px;
}

.card{
    background:white;
    padding:15px;
    margin-bottom:20px;
    border-radius:8px;
    box-shadow:0 0 5px rgba(0,0,0,0.1);
}

h2{
    margin-top:0;
}

/* Table */
table{
    width:100%;
    border-collapse: collapse;
}

th,td{
    border:1px solid #ddd;
    padding:8px;
    text-align:center;
}

th{
    background:#3498db;
    color:white;
}

input,button{
    padding:8px;
    margin:5px;
}

button{
    background:#3498db;
    color:white;
    border:none;
    cursor:pointer;
}

button:hover{
    background:#2980b9;
}

.notif{
    background:#27ae60;
    color:white;
    padding:10px;
    border-radius:5px;
    display:none;
}
</style>
</head>

<body>

<header>
<h1>ðŸ“Š Dashboard Admin Sekolah</h1>
</header>

<div class="container">

<!-- NOTIFIKASI -->
<div id="notif" class="notif"></div>

<!-- INPUT DATA -->
<div class="card">
<h2>âž• Input Data Siswa</h2>

<input type="text" id="nama" placeholder="Nama Siswa">
<input type="number" id="nilai" placeholder="Nilai">
<input type="number" id="hadir" placeholder="Jumlah Hadir">

<button onclick="tambahData()">Tambah</button>
</div>


<!-- DATA SISWA -->
<div class="card">
<h2>ðŸ“‹ Data Siswa</h2>

<table id="tabel">
<thead>
<tr>
<th>No</th>
<th>Nama</th>
<th>Nilai</th>
<th>Hadir</th>
<th>Ranking</th>
</tr>
</thead>

<tbody></tbody>
</table>

<br>
<button onclick="kirimWA()">ðŸ“± Kirim Rekap WA</button>
<button onclick="exportPDF()">ðŸ“„ Export PDF</button>

</div>


<!-- GRAFIK -->
<div class="card">
<h2>ðŸ“ˆ Grafik Perkembangan</h2>

<canvas id="chart"></canvas>

</div>

</div>

<script>

let dataSiswa = [];

const notif = document.getElementById("notif");

function tampilNotif(pesan){
    notif.innerHTML = pesan;
    notif.style.display="block";

    setTimeout(()=>{
        notif.style.display="none";
    },3000);
}

// TAMBAH DATA
function tambahData(){

    let nama = document.getElementById("nama").value;
    let nilai = document.getElementById("nilai").value;
    let hadir = document.getElementById("hadir").value;

    if(nama=="" || nilai=="" || hadir==""){
        alert("Lengkapi data!");
        return;
    }

    dataSiswa.push({
        nama:nama,
        nilai:parseInt(nilai),
        hadir:parseInt(hadir)
    });

    urutkanRanking();
    tampilkanData();
    updateChart();

    tampilNotif("âœ… Data berhasil ditambahkan");

    document.getElementById("nama").value="";
    document.getElementById("nilai").value="";
    document.getElementById("hadir").value="";
}


// SORT RANKING
function urutkanRanking(){
    dataSiswa.sort((a,b)=>b.nilai - a.nilai);
}


// TAMPILKAN DATA
function tampilkanData(){

    let tbody = document.querySelector("#tabel tbody");
    tbody.innerHTML="";

    dataSiswa.forEach((siswa,index)=>{

        let tr = document.createElement("tr");

        tr.innerHTML=`
            <td>${index+1}</td>
            <td>${siswa.nama}</td>
            <td>${siswa.nilai}</td>
            <td>${siswa.hadir}</td>
            <td>${index+1}</td>
        `;

        tbody.appendChild(tr);
    });
}


// SIMULASI KIRIM WA
function kirimWA(){

    let pesan="REKAP SISWA:\n\n";

    dataSiswa.forEach((s,i)=>{
        pesan += `${i+1}. ${s.nama} | Nilai:${s.nilai} | Hadir:${s.hadir}\n`;
    });

    alert("Simulasi Kirim WA:\n\n"+pesan);

    tampilNotif("ðŸ“± Rekap berhasil dikirim ke WA Pembimbing");
}


// EXPORT PDF
function exportPDF(){

    const { jsPDF } = window.jspdf;

    let doc = new jsPDF();

    doc.text("LAPORAN DATA SISWA",70,10);

    let y=25;

    dataSiswa.forEach((s,i)=>{

        doc.text(
        `${i+1}. ${s.nama} | Nilai:${s.nilai} | Hadir:${s.hadir}`,
        10,y);

        y+=8;
    });

    doc.save("laporan_siswa.pdf");

    tampilNotif("ðŸ“„ PDF berhasil dibuat");
}


// CHART
let chart;

function updateChart(){

    let nama = dataSiswa.map(s=>s.nama);
    let nilai = dataSiswa.map(s=>s.nilai);

    if(chart) chart.destroy();

    let ctx = document.getElementById("chart");

    chart = new Chart(ctx,{
        type:"bar",
        data:{
            labels:nama,
            datasets:[{
                label:"Nilai Siswa",
                data:nilai,
                backgroundColor:"#3498db"
            }]
        }
    });

}

</script>

</body>
</html>
