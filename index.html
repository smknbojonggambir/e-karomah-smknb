<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Login E-KAROMAH</title>

<style>
body{
  margin:0;
  font-family:system-ui;
  background:linear-gradient(135deg,#0f172a,#1e293b);
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.card{
  background:rgba(255,255,255,.08);
  padding:30px;
  border-radius:18px;
  width:320px;
  text-align:center;
}

input,select,button{
  width:100%;
  padding:12px;
  margin:10px 0;
  border:none;
  border-radius:10px;
}

button{
  background:#2563eb;
  color:white;
  font-weight:600;
}

.msg{
  color:#ff8080;
  font-size:14px;
}
</style>
</head>

<body>

<div class="card">

<h2>E-KAROMAH</h2>

<select id="role">
  <option value="">Pilih Role</option>
  <option value="siswa">Siswa</option>
  <option value="pembimbing">Pembimbing</option>
  <option value="admin">Admin</option>
</select>

<input id="user" placeholder="Username">

<input id="pass" type="password" placeholder="Password">

<button onclick="login()">LOGIN</button>

<div class="msg" id="msg"></div>

</div>

<script>

const WEB_APP_URL="https://script.google.com/macros/s/AKfycbzVdZoXoZLUREfuu1k1i5BNhySWcDqrKs-VnF0oMZpCLT8NAGETKHBgrPGtK-oOC8M8Ew/exec";

async function login(){

  msg.innerText="";

  if(!role.value||!user.value||!pass.value){
    msg.innerText="Lengkapi data!";
    return;
  }

  msg.innerText="Memeriksa...";

  const url=WEB_APP_URL+
  "?action=login"+
  "&user="+user.value+
  "&pass="+pass.value+
  "&role="+role.value;

  const r=await fetch(url);
  const d=await r.json();

  if(d.status=="ok"){

    localStorage.setItem("user",JSON.stringify(d));

    if(d.role=="siswa") location="siswa.html";
    if(d.role=="pembimbing") location="pembimbing.html";
    if(d.role=="admin") location="admin.html";

  }else{
    msg.innerText="Login gagal!";
  }
}
</script>

</body>
</html>
