<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>E-KAROMAH SMKNB</title>

<style>
body{
font-family:system-ui;
background:#0f172a;
color:#fff;
padding:20px;
}

.card{
max-width:420px;
margin:auto;
background:#1e293b;
padding:25px;
border-radius:12px;
}

input,select,button,textarea{
width:100%;
padding:10px;
margin:8px 0;
border-radius:8px;
border:none;
}

button{
background:#2563eb;
color:white;
font-weight:bold;
cursor:pointer;
}

.hidden{display:none}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="card" id="loginBox">

<h3>Login E-KAROMAH</h3>

<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">

<button onclick="login()">Login</button>

<p id="msg"></p>

</div>


<!-- FORM SISWA -->
<div class="card hidden" id="siswaBox">

<h3>Input Harian</h3>

<p id="info"></p>

<textarea id="kegiatan" placeholder="Kegiatan Hari Ini"></textarea>

<button onclick="kirim()">Kirim</button>

</div>


<!-- DASHBOARD -->
<div class="card hidden" id="monitorBox">

<h3>Dashboard Monitoring</h3>

<p id="monitorInfo"></p>

<a href="https://docs.google.com/spreadsheets/d/1Ho7CWJj0bevgYCzQHs2T6jYi_vjjncM3XRiZvyF8INE"
target="_blank">

<button>Buka Data Laporan</button>

</a>

</div>


<script>

const API="PASTE_WEBAPP_URL_DISINI";

/* LOGIN */
async function login(){

let u=user.value;
let p=pass.value;

let res=await fetch(`${API}?action=login&username=${u}&password=${p}`);
let data=await res.json();

if(data.status!=="success"){
msg.innerHTML="‚ùå Login gagal";
return;
}

/* SIMPAN SESSION */
sessionStorage.setItem("user",JSON.stringify(data));

loginBox.classList.add("hidden");

/* ROLE */
if(data.role==="Siswa"){
tampilSiswa(data);
}else{
tampilMonitor(data);
}

}


/* SISWA */
function tampilSiswa(d){

siswaBox.classList.remove("hidden");

info.innerHTML=`
Nama : ${d.nama}<br>
Kelompok : ${d.kelompok}<br>
Pembimbing : ${d.pembimbing||"-"}
`;

}


/* MONITOR */
function tampilMonitor(d){

monitorBox.classList.remove("hidden");

monitorInfo.innerHTML=`
Login sebagai : <b>${d.role}</b><br>
Nama : ${d.nama}
`;

}


/* KIRIM */
async function kirim(){

let d=JSON.parse(sessionStorage.getItem("user"));

let data={
action:"kirim",
username:d.username,
nama:d.nama,
kelompok:d.kelompok,
kegiatan:kegiatan.value
};

await fetch(API,{
method:"POST",
body:JSON.stringify(data)
});

alert("Berhasil disimpan");

kegiatan.value="";

}

</script>
</body>
</html>
